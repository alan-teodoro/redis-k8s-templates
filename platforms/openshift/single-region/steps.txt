Pre-reqs:
- Install Redis Enterprise Operator (via OperatorHub or manually)
- Apply Security Context Constraints (if not using OperatorHub):
  oc apply -f ../openshift/scc.yaml
  oc adm policy add-scc-to-user redis-enterprise-scc-v2 system:serviceaccount:redis-ns-a:redis-enterprise-operator
  oc adm policy add-scc-to-user redis-enterprise-scc-v2 system:serviceaccount:redis-ns-a:rec
- Enable the admission controller and validating webhook if not installed using OperatorHub
  https://redis.io/docs/latest/operate/kubernetes/deployment/quick-start/#enable-the-admission-controller/

Steps:

1 - Create namespace
    oc apply -f 00-namespace.yaml

2 - Apply admin secret
    oc apply -f 00-rec-admin-secret.yaml

3 - Apply Redis Enterprise Cluster (update apiFqdnUrl and dbFqdnSuffix with your cluster domain)
    oc apply -f 01-rec.yaml

4 - Wait for Redis Enterprise Cluster to be ready (3-5 minutes)
    oc wait --for=condition=Ready rec/rec -n redis-ns-a --timeout=600s
    oc get rec -n redis-ns-a

5 - Apply database secret
    oc apply -f 02-redb-secret.yaml

6 - Apply database configuration
    oc apply -f 03-redb.yaml

7 - Wait for database to be ready
    oc wait --for=condition=Ready redb/redb -n redis-ns-a --timeout=300s

8 - Create Route for UI
    oc apply -f 04-route-ui.yaml

9 - Create Route for Database (optional, for external access)
    oc apply -f 05-route-db.yaml

10 - Get Routes
    oc get route -n redis-ns-a

UI Access:
- Get the route URL: oc get route route-ui -n redis-ns-a -o jsonpath='{.spec.host}'
- Username: admin@redis.com
- Password: RedisAdmin123!

Database Access:
- Get database route: oc get route route-db -n redis-ns-a -o jsonpath='{.spec.host}'
- Get database service (internal): oc get svc -n redis-ns-a | grep redb
- Username: default
- Password: RedisAdmin123!

Database Connection (External via Route):
host: <route-db-host-from-above>
port: 443
username: default
password: RedisAdmin123!

Database Connection (Internal):
host: redb.redis-ns-a.svc.cluster.local
port: 12000
username: default
password: RedisAdmin123!

Security (TLS is enabled by default):
- Enable Use TLS
- Enable Use SNI
- Server name: <route-db-host> or redb.redis-ns-a.svc.cluster.local
- Enable Verify TLS Certificate (optional, use --tls-skip-verify for testing)
- Copy Server certificate from UI if certificate verification is required
- Add CA Certificate and copy certificate content

Test Connection (External):
redis-cli -h <route-db-host> -p 443 --tls --sni <route-db-host> -a RedisAdmin123!

Test Connection (Internal):
redis-cli -h redb.redis-ns-a.svc.cluster.local -p 12000 --tls --sni redb.redis-ns-a.svc.cluster.local -a RedisAdmin123!

Monitoring (Optional):
- Enable user workload monitoring: oc apply -f ../monitoring/servicemonitor.yaml
- Access metrics: OpenShift Console → Observe → Metrics

Load Testing (Optional):
- Deploy memtier: oc apply -f ../testing/memtier-benchmark.yaml
- Run test: See ../testing/README.md for examples

